<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>デートプラン作成画面</title>
</head>
<body>
    <header>
        <h1>デートプラン作成</h1>
    </header>

    <main>
        <button type="button" onclick="history.back()">戻る</button>

        <h2>選択されたスポット</h2>

        <div th:if="${selectedSpots != null and !selectedSpots.isEmpty()}">
            <ul>
                <li th:each="spot, iterStat : ${selectedSpots}">
					<div>
									    
						<img th:src="@{/spot_images/{name}.jpg(name=${spot.spotName})}" alt="スポット画像" style="max-width: 200px;">
					</div>
                    <div>
                        <strong>スポット名:</strong> <span th:text="${spot.spotName}">スポット名</span>
                    </div>
                    <div>
						<strong>カテゴリー:</strong> <span th:text="${spot.categoryName}">スポットのカテゴリー</span>

                    </div>
                    <div>
                        <strong>住所:</strong> <span th:text="${spot.spotAddress}">住所</span>
                    </div>
                    <div>
                        <strong>営業時間:</strong>
                        <div>
                            <strong>月曜日:</strong> <span th:text="${spot.Monday}">月曜日</span>
                        </div>
                        <div>
                            <strong>火曜日:</strong> <span th:text="${spot.Tuesday}">火曜日</span>
                        </div>
                        <div>
                            <strong>水曜日:</strong> <span th:text="${spot.Wednesday}">水曜日</span>
                        </div>
                        <div>
                            <strong>木曜日:</strong> <span th:text="${spot.Thursday}">木曜日</span>
                        </div>
                        <div>
                            <strong>金曜日:</strong> <span th:text="${spot.Friday}">金曜日</span>
                        </div>
                        <div>
                            <strong>土曜日:</strong> <span th:text="${spot.Saturday}">土曜日</span>
                        </div>
                        <div>
                            <strong>日曜日:</strong> <span th:text="${spot.Sunday}">日曜日</span>
                        </div>
                    </div>

                    <!-- 削除ボタン -->
                    <form action="/removeSpotFromPlan" method="post">
                        <input type="hidden" name="spotName" th:value="${spot.spotName}" />
                        <button type="submit">削除</button>
                    </form>

                    <!-- スポットの間に下矢印を表示 -->
                    <div th:if="${iterStat.index < selectedSpots.size() - 1}"> ▼ </div>
                </li>
            </ul>
        </div>

        <div th:if="${selectedSpots == null or selectedSpots.isEmpty()}">
            <p>スポットが追加されていません。</p>
        </div>
		<button type="button" onclick="history.back()">機能一覧画面に戻る</button>
		<div class="button-group">
			<!-- スポットが3つ未満の時だけボタンを有効にする -->
			    <button type="button" 
			            onclick="location.href='/searchSpots'" 
			            th:disabled="${selectedSpots != null and selectedSpots.size() >= 3}"
			            th:style="${selectedSpots != null and selectedSpots.size() >= 3 ? 'opacity: 0.5; cursor: not-allowed;' : ''}">
			        スポット追加
			    </button>
			    
			    <!-- オプション: 3つ以上の場合にメッセージを表示 -->
			    <div th:if="${selectedSpots != null and selectedSpots.size() >= 3}" 
			         style="color: red; font-size: smaller; margin-top: 5px;">
			        ※最大3つまでスポットを追加できます
			    </div>
        </div>
        <form action="/createDatePlan" method="post">
            <input type="hidden" name="spotNames" th:value="${spotNames}" />
            <input type="hidden" name="spotDescriptions" th:value="${spotDescriptions}" />
            <input type="hidden" name="spotAddresses" th:value="${spotAddresses}" />
            <input type="hidden" name="spotOpenings" th:value="${spotOpenings}" />
            
            <!-- 緯度経度の情報も追加 -->
            <input type="hidden" name="spotLatitudes" th:value="${spotLatitudes}" />
            <input type="hidden" name="spotLongitudes" th:value="${spotLongitudes}" />
			<div th:each="spot : ${selectedSpots}">
			    <input type="hidden" name="spotIds" th:value="${spot.spotId}" />
			</div>


            <button type="submit">デートプラン作成</button>
        </form>

        
    </main>
</body>
</html>
