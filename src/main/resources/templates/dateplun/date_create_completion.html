<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>デートプラン - 地図表示</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { width: 70%; height: 450px; }
    </style>
</head>
<body>
    <header>
        <h1>デートプラン - 地図表示</h1>
    </header>

    <main>
        <div id="map"></div>

        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
        <script>
            // 地図の初期設定 (鹿児島中央駅の座標)
            const map = L.map('map').setView([31.5837, 130.5412], 13); // 鹿児島中央駅の座標

            // OpenStreetMapタイルレイヤーを追加
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // 初期位置にピンを立てる（鹿児島中央駅）
            L.marker([31.5837, 130.5412]).addTo(map)
                .bindPopup("<b>鹿児島中央駅</b><br>初期位置のピンです。");

            // Thymeleafで渡されたスポット情報をJavaScriptの変数に設定
            var spotNames = /*[[${spotNames}]]*/ [];
            var spotLatitudes = /*[[${spotLatitudes}]]*/ [];
            var spotLongitudes = /*[[${spotLongitudes}]]*/ [];
            var spotDescriptions = /*[[${spotDescriptions}]]*/ [];
            var spotAddresses = /*[[${spotAddresses}]]*/ [];

            // コンソールで値を確認してみる（デバッグ用）
            console.log('スポット名:', spotNames);
            console.log('緯度:', spotLatitudes);
            console.log('経度:', spotLongitudes);

            // スポット情報を地図にピンとして追加
            for (var i = 0; i < spotNames.length; i++) {
                var lat = spotLatitudes[i];
                var lon = spotLongitudes[i];
                var description = spotDescriptions[i];
                var address = spotAddresses[i];
                var name = spotNames[i];

                // マーカーを追加
                var marker = L.marker([lat, lon]).addTo(map);
                marker.bindPopup("<b>" + name + "</b><br>" + address + "<br>" + description);
            }
        </script>
    </main>
</body>
</html>
